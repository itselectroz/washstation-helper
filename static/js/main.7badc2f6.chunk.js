(this["webpackJsonpwashstation-helper"]=this["webpackJsonpwashstation-helper"]||[]).push([[0],{119:function(e,t,n){},120:function(e,t,n){},136:function(e,t,n){"use strict";n.r(t);var a=n(94),r=n(1),i=n.n(r),c=n(43),o=n.n(c),s=(n(119),n(153)),l=n(13),u=(n(120),n(7)),j=n(151),d=n(152),h=n(166),b=n(107),p=n(158),f=n(15),O=f.e,x=n(5),g=n(16),m=n(97),v=n(20),y=n(96),w=n.n(y),k=Object(m.a)({reducerPath:"washstation-service",baseQuery:Object(v.d)({baseUrl:"https://cors-anywhere-electroz.herokuapp.com/https://mobile.kosmoshub.com/washstation/",prepareHeaders:function(e,t){var n=(0,t.getState)();return n.user.token&&e.set("Authorization","Bearer ".concat(n.user.token)),e.set("X-Requested-With","XMLHttpRequest"),e.set("Content-Type","application/x-www-form-urlencoded"),e}}),endpoints:function(e){return{token:e.mutation({query:function(e){return{url:"/oauth/v2/token",method:"POST",body:w()(Object(g.a)(Object(g.a)({},e),{},{client_id:"1_1881648594",client_secret:"A4f5d4gf59aT4566999999GHJ"}))}}}),profile:e.query({query:function(){return{url:"/api/profile"}}}),machines:e.query({query:function(e){return{url:"/api/catalog/machines/1",headers:{Location:e.toString()}}}}),locations:e.query({query:function(){return{url:"/api/catalog/locations"}}})}}}),S=k.useTokenMutation,C=k.useMachinesQuery,T=k.useLocationsQuery,A=Object(x.d)({name:"user",initialState:{token:null,refreshToken:null,expires:null,profile:null,location_id:-1},reducers:{setLocation:function(e,t){e.location_id=t.payload}},extraReducers:function(e){e.addMatcher(k.endpoints.token.matchFulfilled,(function(e,t){var n=t.payload;e.token=n.access_token,e.refreshToken=n.refresh_token,e.expires=new Date(Date.now()+n.expires_in).toISOString()})),e.addMatcher(k.endpoints.profile.matchFulfilled,(function(e,t){var n=t.payload;e.profile=n,null==e.location_id&&(e.location_id=n.default_location_id)}))}}),L=A.reducer,_=A.actions.setLocation,M=n(50),W=n.n(M),q=n(65),P=n(46),R=n(48),E=function(){function e(){Object(P.a)(this,e)}return Object(R.a)(e,null,[{key:"update",value:function(){var e=Object(q.a)(W.a.mark((function e(t){return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.running?this.alarmTriggered=t.some((function(e){return e.isAvailable})):this.alarmTriggered=!1;case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateRunning",value:function(e){this.running=e,this.running&&this.alarmTriggered&&this.stopAlarm()}},{key:"triggerAlarm",value:function(){this.alarmTriggered=!0}},{key:"stopAlarm",value:function(){this.alarmTriggered=!1}}]),e}();E.running=!1,E.alarmTriggered=!1;var F=n(66),z=n(98),B=n(4),D=["machine"],H=function(e){var t=e.machine,n=Object(F.a)(e,D);return Object(B.jsx)(j.a,Object(g.a)(Object(g.a)({justifyContent:"center"},n),{},{children:Object(B.jsxs)(j.a,{direction:"column",align:"center",children:[Object(B.jsx)(z.a,{size:75,color:"teal"}),Object(B.jsx)(d.a,{maxWidth:"100px",isTruncated:!0,children:t.name}),Object(B.jsx)(d.a,{color:t.isAvailable?"#0a8a64":"red",children:t.isAvailable?"Available":"Busy"}),!t.isAvailable&&t.isBusy&&Object(B.jsxs)(d.a,{children:[Math.floor(t.secLeft/60).toString().padStart(2,"0"),":",(t.secLeft%60).toString().padStart(2,"0")]})]})}))},I=n(154),Q=n(99),J=function(){return Object(B.jsx)(s.a,{mt:5,minWidth:"full",children:Object(B.jsx)(j.a,{minWidth:"full",justifyContent:"center",children:Object(B.jsx)(I.a,{href:"https://www.github.com/itselectroz/washstation-helper",isExternal:!0,children:Object(B.jsxs)(j.a,{align:"center",children:[Object(B.jsx)(d.a,{pr:2,children:"This project is open source"}),Object(B.jsx)(Q.a,{})]})})})})},G=n(155),N=n(111),X=n(156),U=n(157),Y=function(){var e=Object(N.c)(),t=e.colorMode,n=e.toggleColorMode;return Object(B.jsx)(j.a,{children:Object(B.jsx)(G.a,{"aria-label":"Theme Selector",onClick:n,variant:"ghost",icon:"light"===t?Object(B.jsx)(X.a,{}):Object(B.jsx)(U.a,{})})})},K=n(101),V=n.n(K),Z=n.p+"static/media/alarm.7059255a.mp3",$=function(){var e,t=Object(f.d)(),n=O((function(e){return e.user.location_id})),a=C(n,{pollingInterval:500}).data,i=void 0===a?[]:a,c=T().data,o=void 0===c?[]:c;-1!==n&&(e=o.find((function(e){return e.id===n})));var l=Object(r.useState)(!1),x=Object(u.a)(l,2),g=x[0],m=x[1];return E.update(i),Object(B.jsxs)(s.a,{children:[Object(B.jsx)(V.a,{url:Z,playStatus:E.alarmTriggered?"PLAYING":"STOPPED",loop:!0}),Object(B.jsxs)(j.a,{minHeight:"100vh",minWidth:"full",justifyContent:"center",align:"center",children:[Object(B.jsxs)(s.a,{children:[Object(B.jsxs)(s.a,{borderWidth:1,borderRadius:4,px:6,width:"full",maxWidth:"650px",textAlign:"center",boxShadow:"lg",py:5,children:[Object(B.jsxs)(j.a,{align:"center",justifyContent:"center",children:[Object(B.jsx)(p.a,{onChange:function(e){t(_(e.target.value))},flex:5,placeholder:e?e.name:"Not Set",children:o.map((function(e){return Object(B.jsx)("option",{value:e.id,children:e.name})}))}),Object(B.jsx)(s.a,{flex:1}),Object(B.jsx)(b.a,{flex:3,textAlign:"center",onClick:function(){E.updateRunning(!g),m(!g)},children:g?"Stop":"Start"}),Object(B.jsx)(d.a,{flex:3,textAlign:"center",color:g?"#0a8a64":"red",children:g?"Running":"Stopped"})]}),Object(B.jsx)(j.a,{minWidth:"full",justifyContent:"center",my:5,children:Object(B.jsx)(s.a,{height:.25,width:"90%",bg:"teal"})}),Object(B.jsx)(h.a,{children:i.map((function(e){return Object(B.jsx)(H,{machine:e,px:4})}))})]}),Object(B.jsx)(J,{})]}),Object(B.jsx)(s.a,{pos:"absolute",top:"0",left:"0",children:Object(B.jsx)(Y,{})})]})]})},ee=n(164),te=n(160),ne=n(108),ae=n(161),re=function(){var e=Object(ee.a)(),t=Object(l.g)().push,n=i.a.useState({username:"",password:"",grant_type:"password"}),a=Object(u.a)(n,2),r=a[0],c=a[1],o=S(),h=Object(u.a)(o,2),p=h[0],f=h[1].isLoading,O=k.endpoints.profile.useLazyQuerySubscription(),x=Object(u.a)(O,1)[0],m=Object(N.d)("teal","teal");function v(){return(v=Object(q.a)(W.a.mark((function n(a){var i;return W.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a.preventDefault(),n.prev=1,n.next=4,p(r).unwrap();case 4:if((i=n.sent)&&i.access_token){n.next=7;break}throw new Error;case 7:x(),t("/"),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(1),e({status:"error",title:"Error",description:"Oh no, there was an error!",isClosable:!0});case 14:case"end":return n.stop()}}),n,null,[[1,11]])})))).apply(this,arguments)}return Object(B.jsxs)(j.a,{minHeight:"100vh",minWidth:"full",justifyContent:"center",align:"center",children:[Object(B.jsxs)(s.a,{children:[Object(B.jsx)(s.a,{borderWidth:1,borderRadius:4,px:6,width:"full",maxWidth:"500px",textAlign:"center",boxShadow:"lg",py:5,children:Object(B.jsxs)("form",{onSubmit:function(e){return v.apply(this,arguments)},children:[Object(B.jsx)(te.a,{children:"Login with Washstation"}),Object(B.jsx)(d.a,{children:"This is not an official washstation site"}),Object(B.jsx)(ne.a,{mt:5,children:Object(B.jsx)(ae.a,{type:"email",placeholder:"Email",onChange:function(e){return c(Object(g.a)(Object(g.a)({},r),{},{username:e.target.value}))}})}),Object(B.jsx)(ne.a,{mt:3,children:Object(B.jsx)(ae.a,{type:"password",placeholder:"Password",onChange:function(e){return c(Object(g.a)(Object(g.a)({},r),{},{password:e.target.value}))}})}),Object(B.jsx)(b.a,{minWidth:"full",mt:5,bg:m,textColor:"white",type:"submit",isLoading:f,children:"Login"})]})}),Object(B.jsx)(J,{})]}),Object(B.jsx)(s.a,{pos:"absolute",top:"0",left:"0",children:Object(B.jsx)(Y,{})})]})},ie=["component"],ce=function(e){var t=e.component,n=Object(F.a)(e,ie),a=O((function(e){return!!e.user.token}));return Object(B.jsx)(l.b,Object(g.a)(Object(g.a)({},n),{},{render:function(e){return a?Object(B.jsx)(t,Object(g.a)({},e)):Object(B.jsx)(l.a,{to:{pathname:"/login",state:{from:e.location}}})}}))};var oe,se=function(){return Object(B.jsx)(s.a,{children:Object(B.jsxs)(l.d,{children:[Object(B.jsx)(l.b,{exact:!0,component:re,path:"/login"}),Object(B.jsx)(ce,{exact:!0,component:$,path:"/"})]})})},le=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,167)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),a(e),r(e),i(e),c(e)}))},ue=n(165),je=n(163),de=n(3),he=Object(x.a)({reducer:Object(de.a)({user:L},k.reducerPath,k.reducer),middleware:function(e){return e().concat(k.middleware)}}),be=n(62),pe=n(162),fe=Object(pe.a)({config:{initialColorMode:"light",useSystemColorMode:!1}}),Oe=(n(135),n(28)),xe=Object(Oe.b)(oe||(oe=Object(a.a)(["\n  /*\n    This will hide the focus indicator if the element receives focus    via the mouse,\n    but it will still show up on keyboard focus.\n  */\n  .js-focus-visible :focus:not([data-focus-visible-added]) {\n     outline: none;\n     box-shadow: none;\n   }\n"])));o.a.render(Object(B.jsx)(i.a.StrictMode,{children:Object(B.jsx)(f.a,{store:he,children:Object(B.jsx)(ue.a,{children:Object(B.jsxs)(be.a,{children:[Object(B.jsx)(Oe.a,{styles:xe}),Object(B.jsx)(je.a,{initialColorMode:fe.config.initialColorMode}),Object(B.jsx)(se,{})]})})})}),document.getElementById("root")),le()}},[[136,1,2]]]);
//# sourceMappingURL=main.7badc2f6.chunk.js.map